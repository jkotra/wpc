steps:
  # Install Rust using rustup
  - name: "rust:latest"
    id: "Install Rust"
    entrypoint: "sh"
    args:
      - "-c"
      - |
        rustup update
        rustc --version
        cargo --version

  # Cache dependencies
  - name: "rust:latest"
    id: "Cache Dependencies"
    entrypoint: "sh"
    args:
      - "-c"
      - |
        cargo fetch

  # Build the project
  - name: "rust:latest"
    id: "Build"
    entrypoint: "sh"
    args:
      - "-c"
      - |
        cargo build --release

  # Run tests
  - name: "rust:latest"
    id: "Test"
    entrypoint: "sh"
    args:
      - "-c"
      - |
        cargo test --release --verbose

timeout: "1200s"  # Set timeout (20 minutes)
